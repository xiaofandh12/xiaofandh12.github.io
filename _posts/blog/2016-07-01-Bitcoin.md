---
layout: post
title: 比特币的基本原理 -- 数十年来密码学、分布式系统和货币研究的巅峰之作
description: 比特币, Bitcoin, 区块链, Blockchain
category: blog
---

## 目录

* 支付手段的演变
* 比特币的基本原理
	* 概述
	* 总账本，即区块链
	* 产生交易
	* 收集交易，产生区块
	* 确认交易，产生区块链
	* 比特币的所有权问题
	* 比特币的双重支付问题
	* 总结
* 比特币的问题
* 其它方面
* 参考资料


## 支付手段的演变

从古至今支付手段都是处于不断的发展和变化之中，大致上经历了以物易物、实物货币(黄金)、符号货币(人民币、美元等)、中央系统虚拟货币(银行、支付宝、微信支付等)、分布式系统虚拟货币几个阶段，其中比特币便是分布式系统虚拟货币的开山之作。一般来说，自我们人类存在以来，大致可以按照上古时代、农业时代、工业时代、信息时代来划分，其实当从货币支付角度来看的时候，每个时代都伴随着新的支付手段的产生，而比特币这种新型的分布式系统虚拟货币的诞生，是不是意味着下一个时代的诞生呢？

货币必须要具备一些基本的属性，比如要稀少、珍贵、便携，产生速度不易过快或过慢，最好是可控的，只有在具备了这些基本属性之后，才有可能被广泛的接收，使得货币在人类的各种交易中发挥其作用。

货币具备了一些基本属性之后，还必须得有手段保证其发行量、防伪、购买力。实物货币是靠天然的产量限制货币的发行量，靠天然的化学属性进行防伪，靠天然的珍稀性保证购买力；符号货币靠中央银行的领导和经济专家决定发行多少货币，靠不断的提高制作工艺和更高级的验钞机进行货币防伪，靠国家力量来保证购买力；中央系统虚拟货币靠中央银行的领导和经济专家决定发行多少货币，靠中央系统的总账本记录所有交易进行货币防伪，靠国家力量来保证购买力；分布式系统虚拟货币靠指定总量来决定发行多少货币，靠区块的产生速度来控制货币的发行速度，靠分布式系统的总账本(区块链)记录所有交易以及密码学来进行货币防伪，靠其天然的珍稀性保证购买力。比特币能否被广泛的接收，进而成为一种有效的分布式系统虚拟货币，还有待长期的观察和改进，不过它绝对是一次伟大而重要的尝试。

## 比特币的基本原理

### 概述

中本聪在2008年发表论文"A peer-to-peer electronic cash system"，标志着比特币的诞生，没过多久中本聪又编写了bitcoin core(比特币核心)，产生了第一个区块和第一笔交易。中本聪在第一个交易中，写下了"The Times 03/Jan/2009 Chancellor on brink of second bailout for banks(2009年1月3日，财政大臣正站在第二轮救助银行业的边缘)"，一方面标志着比特币在这一天正式开始运行，另一方面讽刺了当前货币制度的不合理性。在发表了论文和编写了比特币核心，并使系统稳定运行了一段时间后，中本聪逐渐淡出公众视野，到现在也不知道中本聪真名叫什么，到底是谁。

货币的一切都是在保证交易的正常进行，在中央系统虚拟货币中，我们之所以可以正常的进行交易，是因为我们在中央系统有一个账号及对应的密码，另外中央系统中会记录每个账号所有的交易信息。在一定程度上来说，比特币也类似于中央系统虚拟货币，只是比特币是把所有的交易记录在区块链中，而区块链又是完全公开的，只要满足一定的条件谁都可以在区块链中记录下交易。

总结起来，比特币需要解决的就是两个问题：比特币的所有权问题和比特币的双重支付问题。在交易中来分析，比特币的所有权问题就是在交易的时候有没有足够的比特币以及使用的比特币确实是属于你的，比特币的双重支付问题就是要保证已经使用过的比特币不会再被使用。我们要明白一点，比特币并不是一张纸或是某个具体的数字，一个人拥有多少比特币是根据你在总账本(区块链)中的交易记录来查询的，其实在中央系统虚拟货币中也应该是这么做的。

再来分析一下，比特币的两个问题在中央系统虚拟货币中是怎么解决的。所有权问题，因为我们在中央系统中有账号和密码，所以根据提供的账号就可以查询出该账号的所有交易信息，再根据这些交易信息计算出一些统计信息，这些统计信息中就包括该账号的余额，当进行一笔交易时，只要余额足够就可以成功交易。双重支付问题在中央系统虚拟货币中是不存在的，因为中央系统的账本只有中央系统可以书写。

在分布式系统中账本(区块链，记录了所有的交易信息)是完全公开的，这个特性引起了上述两个问题，而比特币以创造性的方法成功的解决了这两个问题。完全公开的账本(区块链)也带来了很多好处，比如我们的交易不再依赖某个中央系统，谁都可以进行审计等等。

数字货币的研究由来已久，所以所有权问题并不是中本聪在论文中主要考虑的问题，该论文的最大的创新之处，在于完美的解决了双重支付问题。

### 总账本，即区块链

我们可以把区块链理解为一个数据结构，而比特币是使用该数据结构实现中央系统虚拟货币的一个算法。

交易是指某个比特币地址向另一个比特币地址支付了某数量的比特币；区块是指包含区块头和多个交易信息的一个结构体；区块链是指区块链接而成的一个链表。我们可以把区块链理解为一个链表，这个链表中的每个节点是一个区块，区块中又包含了一定数量的交易信息。

区块的产生速度是在算法中通过调整难度来控制的，基本上是每十分钟产生一个有效区块，该区块中包含了这段时间或更早时间的一些交易信息，每两个星期会根据区块产生的速度来调整难度，以保证每十分钟产生一个有效区块的目标。我们可以在网站[Blockchain info](https://blockchain.info)上来查询区块链中的信息，如某个交易的信息，某个区块的信息，某个比特币地址的所有交易，当前的区块链长度等等，可以看到区块链确确实实是完全公开的。

### 产生交易

![bitcoin core windows](/images/2016-07-01-Bitcoin/bitcoincore2.png)

![bitcoin core windows](/images/2016-07-01-Bitcoin/bitcoincore1.png)

![get block info](/images/2016-07-01-Bitcoin/getblock.png)

![get raw transaction](/images/2016-07-01-Bitcoin/getrawtransaction.png)

![transaction](/images/2016-07-01-Bitcoin/transaction.png)

![Unspent Transaction Output](/xiaofandh12.github.io/images/2016-07-01-Bitcoin/utxo.png)

### 收集交易，产生区块

![generator block](/images/2016-07-01-Bitcoin/blockgener.png)

![merkle tree](/images/2016-07-01-Bitcoin/merkletree.png)

### 确认交易，产生区块链

![block chain](/images/2016-07-01-Bitcoin/blockchain.png)

![generator block](/images/2016-07-01-Bitcoin/blockgener.png)

![p2p network](/images/2016-07-01-Bitcoin/p2pnetwork.png)

![main chain](/images/2016-07-01-Bitcoin/mainchain1.png)

![main chain](/images/2016-07-01-Bitcoin/mainchain2.png)

![main chain](/images/2016-07-01-Bitcoin/mainchain3.png)

![main chain](/images/2016-07-01-Bitcoin/mainchain4.png)

![main chain](/images/2016-07-01-Bitcoin/mainchain5.png)

### 比特币的所有权问题

![transaction](/images/2016-07-01-Bitcoin/transaction.png)

![private key, public key and bitcoin address](/images/2016-07-01-Bitcoin/pubandprikey.png)

![P2PKH](/images/2016-07-01-Bitcoin/p2pkh.png)

![P2PKH validation](/images/2016-07-01-Bitcoin/p2pkhvalidation.png)

### 比特币的双重支付问题

![block chain](/images/2016-07-01-Bitcoin/blockchain.png)

### 总结

## 比特币的问题

![cumulative BTC in circulation](/images/2016-07-01-Bitcoin/chanliang.png)

![mining](/images/2016-07-01-Bitcoin/miningdis.png)


## 其它方面

![DAO](/images/2016-07-01-Bitcoin/dao.png)

![Trade](/images/2016-07-01-Bitcoin/trade.png)

![bikan](/images/2016-07-01-Bitcoin/bitcoinbikan.png)

## 参考资料

* [A peer-to-peer electronic cash system](https://bitcoin.org/bitcoin.pdf)
* [精通比特币](http://zhibimo.com/read/wang-miao/mastering-bitcoin/index.html)
* [Bitcoin Core Developer Documentation](https://bitcoin.org/en/developer-documentation
)
* [Bitcoin Core Developer Guide](https://bitcoin.org/en/developer-guide)
* [A gentle introduction to bitcoin](https://bitsonblocks.net/2015/09/01/a-gentle-introduction-to-bitcoin/)
* [A gentle introduction to bitcoin mining](https://bitsonblocks.net/2015/09/21/a-gentle-introduction-to-bitcoin-mining/)
* [A gentle introduction to blockchain technology](https://bitsonblocks.net/2015/09/09/a-gentle-introduction-to-blockchain-technology/)
* [A gentle introduction to digital tokens](https://bitsonblocks.net/2015/09/28/a-gentle-introduction-to-digital-tokens/)
* [A gentle introduction to immutability of blockchain](https://bitsonblocks.net/2016/02/29/a-gentle-introduction-to-immutability-of-blockchains/)
* [一个故事告诉你比特币的原理及运行机制](http://blog.codinglabs.org/articles/bitcoin-mechanism-make-easy.html)
* [区块链—比特币的灵魂，下一个风口](http://36kr.com/p/5041713.html)
* [重重迷雾包裹下的区块链技术](http://chainb.com/?P=Cont&id=1228)
* [比特币区块链开发由浅入深指南（一）](http://www.8btc.com/blockchain_develope_lesson_1)
* [比特币区块链开发由浅入深指南（二）](http://www.8btc.com/ppkpub_blockchain_develope_lesson_2)
* [Github Bitcoin](https://github.com/bitcoin/bitcoin
Source Code Documentation: https://dev.visucore.com/bitcoin/doxygen/)
* [Bitcoin wiki](https://en.bitcoin.it/wiki/Main_Page)
* [bitcoin talk](https://bitcointalk.org)
* [BTCChina](https://www.btcc.com)
* [Blockchain Info](https://blockchain.info)
* [合约币](http://counterparty.io)
* [以太坊](http://ethfans.org)
* 手机应用 -- OKCoin
* 手机应用 -- 币看比特币
* 微信公众号：区块链铅笔Blockchain(chainbcom)
